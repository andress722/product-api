<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista de Produtos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h1 class="text-center mb-4">Lista de Produtos</h1>
    <div class="text-end mb-3">
      <a href="/create" class="btn btn-primary">Adicionar Produto</a>
    </div>
    <% products.forEach(product => { %>
      <div class="card mb-4">
        <div class="card-header bg-dark text-white">
          <h3><%= product.name %></h3>
        </div>
        <div class="card-body">
          <p><strong>Marca:</strong> <%= product.brand %></p>
          <p><strong>Categoria:</strong> <%= product.category %></p>
          <p><strong>Descrição:</strong> <%= product.description %></p>
          <h5>Detalhes:</h5>
          <% product.sizes.forEach(size => { %>
            <div class="mt-3">
              <h6><strong>Tamanho:</strong> <%= size.size %></h6>
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>Cor</th>
                    <th>Quantidade</th>
                    <th>Preço</th>
                    <th>Promoção</th>
                    <th>Desconto</th>
                    <th>Preço Final</th>
                  </tr>
                </thead>
                <tbody>
                  <% size.variants.forEach(variant => { %>
                    <tr>
                      <td><%= variant.color %></td>
                      <td><%= variant.quantity %></td>
                      <td>R$ <%= variant.price.toFixed(2) %></td>
                      <td><%= variant.onSale ? 'Sim' : 'Não' %></td>
                      <td><%= variant.discount ? variant.discount + '%' : '-' %></td>
                      <td>R$ <%= variant.finalPrice ? variant.finalPrice.toFixed(2) : variant.price.toFixed(2) %></td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>
            </div>
          <% }) %>
        </div>
        <div class="card-footer text-end">
          <a href="/edit/<%= product._id %>" class="btn btn-warning btn-sm">Editar</a>
          <a href="/delete/<%= product._id %>" class="btn btn-danger btn-sm" onclick="return confirm('Tem certeza que deseja excluir este produto?')">Excluir</a>
        </div>
      </div>
    <% }) %>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
